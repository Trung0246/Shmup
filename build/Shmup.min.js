//Shmup.js v1.0.12 || MIT License || Copyright (c) 2016 Trung0246 || https://github.com/Trung0246/Shmup
!function(a){"use strict";function i(a){e[g].isFiring[a]=!1,e[g].fire.temp[a]={},e[g].commands[a]=[{location:0,times:1,actions:b[g].actions.fire[a],label:a}],e[g].wait[a]={}}function j(a,b){a=f[a.type].draw(a),d.actions(a.actionRef,b,a.commands[a.commands.length-1].actions,a.commands,void 0,a)}function k(){return(1e36*Math.random()).toString(36)}function l(a,b){if("function"==typeof a)return b?a:l(a());if("number"==typeof a||"boolean"==typeof a||"object"==typeof a){if(!Number.isNaN(a)||Array.isArray(a)||a instanceof Object)return a;throw new Error("Invalid data")}if("string"==typeof a)return Number.isNaN(a)||b?a:Number(a);throw new Error("Invalid data")}function m(a,b){if(null==a||"object"!=typeof a)return a;if(a.constructor!=Object&&a.constructor!=Array)return a;if(a.constructor==Date||a.constructor==RegExp||a.constructor==Function||a.constructor==String||a.constructor==Number||a.constructor==Boolean)return new a.constructor(a);b=b||new a.constructor;for(var c in a)b[c]="undefined"==typeof b[c]?m(a[c],null):b[c];return b}function n(a,b){if(null==a||"object"!=typeof a)return a;if(a.constructor!=Object&&a.constructor!=Array)return a;if(a.constructor==Date||a.constructor==RegExp||a.constructor==Function||a.constructor==String||a.constructor==Number||a.constructor==Boolean)return new a.constructor(a);b=b||new a.constructor;for(var c in a)b[c]="undefined"==typeof b[c]?"function"==typeof a[c]?"movement"===c?a[c]:a[c]():n(a[c],null):b[c];return b}function o(a){function c(a,d){if(null==a||"object"!=typeof a)return a;if(a.constructor!=Object&&a.constructor!=Array)return a;if(a.constructor==Date||a.constructor==RegExp||a.constructor==Function||a.constructor==String||a.constructor==Number||a.constructor==Boolean)return new a.constructor(a);d=d||new a.constructor;for(var e in a)d[e]="undefined"==typeof d[e]?"function"==typeof a[e]?function(){return"direction"===b&&"movement"===e?a[e]:"wait"===b&&"times"===e?a[e]:"freeze"===b&&"times"===e?a[e]:a[e]()}():c(a[e],null,function(){"func"===e&&"wait"===a[e]&&void 0===b&&(b="wait"),"func"===e&&"freeze"===a[e]&&void 0===b&&(b="freeze"),"func"===e&&"direction"===a[e]&&void 0===b&&(b="direction")}()):d[e];return d}var b;return c(a)}function p(a){return b[g].configs.angleType||(b[g].configs.angleType="degree"),"degree"===l(b[g].configs.angleType,!0)?Math.degToRad(Math.normalizeDegree(a)):"radian"===l(b[g].configs.angleType,!0)?Math.normalizeRadian(a):void 0}function q(a,c){return"degree"!==b[g].configs.angleType&&b[g].configs.angleType?"radian"===b[g].configs.angleType?-Math.atan2(a[0]-c[0],-(a[1]-c[1])):void 0:Math.radToDeg(-Math.atan2(a[0]-c[0],-(a[1]-c[1])))}var g,h,b={},c={},d={},e={},f={};return c.configs=function(a){a.fire&&"object"==typeof a.fire||(a.fire={});for(var c in a.shot)a.shot[c].count(0);return b[g].configs=a,this},c.actions=function(a,c,d){return b[g].actions||(b[g].actions={}),e[g].frame||(e[g].frame=0),c?(b[g].actions.fire||(b[g].actions.fire={}),b[g].actions.fire[a]||(b[g].actions.fire[a]=d)):(b[g].actions.ref||(b[g].actions.ref={}),b[g].actions.ref[a]||(b[g].actions.ref[a]=d)),e[g].bullets||(e[g].bullets={}),!e[g].bullets[a]&&c&&(e[g].bullets[a]={}),e[g].count||(e[g].count={}),e[g].fire||(e[g].fire={}),e[g].fire.data||(e[g].fire.data={}),e[g].fire.temp||(e[g].fire.temp={}),e[g].fire.data[a]=m(b[g].configs.fire),e[g].fire.temp[a]||(e[g].fire.temp[a]={}),e[g].commands||(e[g].commands={}),e[g].commands[a]||(e[g].commands[a]=[{location:0,times:1,actions:d,label:a}]),e[g].wait||(e[g].wait={}),e[g].wait[a]||(e[g].wait[a]={}),e[g].freeze||(e[g].freeze={}),!e[g].freeze[a]&&c&&(e[g].freeze[a]={}),c&&(e[g].isFiring||(e[g].isFiring={}),e[g].isFiring[a]||(e[g].isFiring[a]=!1)),c&&(e[g].isFreezing||(e[g].isFreezing={}),e[g].isFreezing[a]||(e[g].isFreezing[a]=!1)),this},c.fire=function(a){if("undefined"!=typeof a){if(!(a.length>0))throw new Error("Undefined label list");for(var c=0;c<a.length;c++){if(e[g].isFiring[a[c]]===!1&&1===e[g].commands[a[c]].length&&(e[g].isFiring[a[c]]=!0),!b[g].actions.fire[a[c]]||1!==e[g].commands[a[c]].length)throw new Error("Undefined actions of "+a[c]+" or is firing");d.actions(a[c],a[c],e[g].commands[a[c]][e[g].commands[a[c]].length-1].actions,e[g].commands[a[c]],void 0,void 0)}}},c.update=function(a){function i(a){e[g].isFiring[a]===!0&&("manual"!==e[g].wait[a].type?(e[g].wait[a].times>0&&e[g].wait[a].times--,(e[g].wait[a].times<=0||void 0===e[g].wait[a].times)&&(e[g].wait[a].times<=0&&(e[g].wait[a].times=void 0),d.actions(a,a,e[g].commands[a][e[g].commands[a].length-1].actions,e[g].commands[a],void 0,void 0))):e[g].wait[a].times()===!0&&d.actions(a,a,e[g].commands[a][e[g].commands[a].length-1].actions,e[g].commands[a],void 0,void 0));for(var c in e[g].bullets[a])"manual"!==e[g].freeze[a][c].type?(e[g].freeze[a][c].times>0&&e[g].freeze[a][c].times--,e[g].freeze[a][c].times<=0&&(e[g].freeze[a][c].times=void 0,e[g].freeze[a][c].done=!0)):e[g].freeze[a][c].done=e[g].freeze[a][c].times();for(var c in e[g].bullets[a]){for(var h=e[g].bullets[a][c],i=0;i<h.length;i++)!function(){var k=e[g].bullets[a][c][i];if(null!==k){j(a,c)&&(k=f[b[g].configs.shot[k.type].type].draw(k),k.count=i,k.actionRef&&("manual"!==k.wait.type?(k.wait.times>0&&k.wait.times--,(k.wait.times<=0||void 0===k.wait.times)&&(k.wait.times<=0&&(k.wait.times=void 0),k.commands.length>0&&d.actions(k.actionRef,a,k.commands[k.commands.length-1].actions,k.commands,void 0,k))):k.wait.times()===!0&&(k.wait.times=void 0,d.actions(k.actionRef,a,k.commands[k.commands.length-1].actions,k.commands,void 0,k)))),j(a,c)?b[g].configs.shot[k.type].draw(k):"function"!=typeof b[g].configs.shot[k.type].freeze?b[g].configs.shot[k.type].draw(k):b[g].configs.shot[k.type].freeze(k);var l=k.type;if(b[g].configs.shot[k.type].callback&&j(a,c)){var m=b[g].configs.shot[k.type].callback(k.actionRef||a,a,function(){try{return k.commands[k.commands.length-1].actions}catch(a){return}}(),k.commands,void 0,k);m||(m={}),m.func&&d[m.func](k.actionRef,a,void 0,void 0,m,k)}b[g].configs.shot[l].count(e[g].count[l])}}();if(h.indexOf(null)>-1)for(var k=h.length-1;k>=0;--k)null===h[k]&&h.splice(k,1)}}function j(a,b){return e[g].freeze[a][b].done?e[g].isFreezing[a]!==!0:"undefined"==typeof e[g].freeze[a][b].done&&(e[g].isFreezing[a]===!1||void 0)}if("undefined"==typeof a)for(var c in b[g].actions.fire)i(c);else{if(!(a.length>0))throw new Error("No action to update");for(var h=0;h<a.length;h++)i(a[h])}e[g].frame++,b[g].configs.frame(e[g].frame)},c.freeze=function(a){if("string"==typeof a)e[g].isFreezing[a]=!0;else{if(!(a.length>0))throw new Error("No action to freeze");for(var b=0;b<a.length;b++)e[g].isFreezing[a[b]]=!0}},c.continue=function(a){if("string"==typeof a)e[g].isFreezing[a]=!1;else{if(!(a.length>0))throw new Error("No action to continue");for(var b=0;b<a.length;b++)e[g].isFreezing[a[b]]=!1}},c.clear=function(a){function h(a,c){for(var f=e[g].bullets[a][c],h=0;h<f.length;h++)!function(){var i=e[g].bullets[a][c][h];if(null!==i){var j=i.type;d.vanish(a,a,void 0,void 0,{type:"all",label:i.label},i),b[g].configs.shot[j].count(e[g].count[j])}}();if(f.indexOf(null)>-1)for(var i=f.length-1;i>=0;--i)null===f[i]&&f.splice(i,1)}if("string"==typeof a)for(var c in e[g].bullets[a])h(a,c);else{if(!(a.length>0))throw new Error("No action to clear");for(var f=0;f<a.length;f++)for(var c in e[g].bullets[a[f]])h(a[f],c)}},c.pause=function(a){if("string"==typeof a)e[g].isFiring[a]=!1;else{if(!(a.length>0))throw new Error("No action to pause");for(var b=0;b<a.length;b++)e[g].isFiring[a[b]]=!1}},c.run=function(a){if("string"==typeof a)e[g].isFiring[a]=!0;else{if(!(a.length>0))throw new Error("No action to run");for(var b=0;b<a.length;b++)e[g].isFiring[a[b]]=!0}},c.stop=function(a){function c(a){e[g].isFiring[a]===!0&&i(a)}if("string"==typeof a)c(a);else{if(!(a.length>0))throw new Error("No action to stop");for(var b=0;b<a.length;b++)c(a[b])}},d.actions=function(a,b,c,e,f,g){var h=[{location:0,times:1,actions:c,label:a}];a===b?e||(e=h):a!==b&&(g.commands||(g.commands=h,e=g.commands));var k;!function f(){for(;e[e.length-1].times>0;){for(;e[e.length-1].location<c.length;){if(k=d[c[e[e.length-1].location].func](a,b,c,e,c[e[e.length-1].location],g),"string"==typeof k)return;"object"==typeof k&&k.actionRef&&j(k,b),e[e.length-1].location++}e[e.length-1].location=0,e[e.length-1].times--}try{if(e.pop(),e.length<=0)return void(a===b&&i(b));c=e[e.length-1].actions,f()}catch(a){}}(),"repeat"===k&&d.actions(a,b,e[e.length-1].actions,e,f,g)},d.repeat=function(a,b,c,d,e,f){e.label||(e.label=k());var g=n(e);return d.push({actions:c[d[d.length-1].location].actions,location:0,times:g.times,label:g.label||function(){var a=k();return g.label=a,a}()}),d[d.length-2].location++,"repeat"},d.wait=function(a,b,c,d,f,h){f.label||(f.label=k());var i=n(f);return"manual"===i.type&&(i=o(f)),a===b?(e[g].wait[a].label=i.label,e[g].wait[a].times=i.times,e[g].wait[a].type=i.type):a!==b&&(h.wait.label=i.label,h.wait.times=i.times,h.wait.type=i.type),d[d.length-1].location++,"wait"},d.fire=function(a,c,d,h,i,j){i.label||(i.label=k());var l=n(i);l.fireRef&&(l.label=l.fireRef,l.type||(l.type=e[g].fire.data[a][l.label].type)),e[g].bullets[c][l.label]||(e[g].bullets[c][l.label]=[]),e[g].freeze[c][l.label]||(e[g].freeze[c][l.label]={}),f[b[g].configs.shot[l.type].type].fire(a,c,d,h,l,j)},d.vanish=function(a,c,d,h,i,j){var k=n(i);f[b[g].configs.shot[function(){if(a===c){if(k.label)return e[g].fire.data[a][k.label].type;throw new Error("Label must be defined in vanish main action")}if(a!==c&&j)return k.label?e[g].fire.data[a][k.label].type:j.type;throw new Error("Label must be defined in vanish commands")}()].type].vanish(a,c,d,h,k,j)},d.change=function(a,c,d,e,h,i){f[b[g].configs.shot[i.type].type].change(a,c,d,e,n(h),i)},d.freeze=function(a,c,d,h,i,j){var k=n(i);if(a!==c)throw new Error("Freeze command can only use in main action");if("manual"===k.type&&(k=o(i)),!k.label)throw new Error("Label didn't defined");e[g].freeze[a][k.label].times=k.times,e[g].freeze[a][k.label].type=k.type,e[g].freeze[a][k.label].done=!1,f[b[g].configs.shot[e[g].fire.data[a][k.label].type].type].freeze(a,c,d,h,k,j)},d.reset=function(a,c,d,h,i,j){var k=n(i);f[b[g].configs.shot[function(){if(a===c)return e[g].fire.data[a][k.label].type;if(a!==c&&j)return k.label?e[g].fire.data[a][k.label].type:j.type;throw new Error("Label must be defined in reset commands")}()].type].reset(a,c,d,h,k,j)},d.func=function(a,b,c,d,e,f){e.callback(a,b,c,d,e,f)},f.bullet={fire:function(a,c,d,f,h,i){if(h.fireRef){var j=e[g].fire.data[a][h.label];!h.movement&&j.movement&&(h.movement=j.movement),!h.position&&j.position?h.position=m(j.position):h.position&&j.position&&(!h.position.now&&j.position.now&&(h.position.now=j.position.now.slice()),!h.position.end&&j.position.end&&(h.position.end=j.position.now.slice())),!h.direction&&j.direction?h.direction=m(j.direction):h.direction&&j.direction?("number"!=typeof h.direction.value&&(h.direction.value=j.direction.value),"number"!=typeof h.direction.base&&(h.direction.base=j.direction.base),h.direction.type||(h.direction.type=j.direction.type),h.direction.target||(h.direction.target=j.direction.target)):h.movement||h.position.end||(h.direction={value:0,type:"absolute"}),!h.speed&&j.speed?h.speed=j.speed:h.speed&&j.speed?(!h.speed.horizontal&&j.speed.horizontal?h.speed.horizontal=j.speed.horizontal:h.speed.horizontal&&j.speed.horizontal?("number"!=typeof h.speed.horizontal.value&&(h.speed.horizontal.value=j.speed.horizontal.value),"number"!=typeof h.speed.horizontal.base&&(h.speed.horizontal.base=j.speed.horizontal.base),h.speed.horizontal.type||(h.speed.horizontal.type=j.speed.horizontal.type)):h.speed.horizontal={value:1,type:"absolute"},!h.speed.vertical&&j.speed.vertical?h.speed.vertical=j.speed.vertical:h.speed.vertical&&j.speed.vertical?("number"!=typeof h.speed.vertical.value&&(h.speed.vertical.value=j.speed.vertical.value),"number"!=typeof h.speed.horizontal.base&&(h.speed.horizontal.base=j.speed.horizontal.base),h.speed.vertical.type||(h.speed.vertical.type=j.speed.vertical.type)):h.speed.vertical={value:1,type:"absolute"}):h.movement||(h.speed={horizontal:{value:1,type:"absolute"},vertical:{value:1,type:"absolute"}}),!h.actionRef&&j.actionRef&&(h.actionRef=j.actionRef)}e[g].fire.data[a][h.label]||(e[g].fire.data[a][h.label]=m(h),delete e[g].fire.data[a][h.label].label,delete e[g].fire.data[a][h.label].func),e[g].fire.temp[a][h.label]||(e[g].fire.temp[a][h.label]={direction:{value:void 0,root:void 0,type:void 0,base:void 0},speed:{horizontal:{value:void 0,root:void 0,type:void 0,base:void 0},vertical:{value:void 0,root:void 0,type:void 0,base:void 0}}});var l={type:h.type,label:h.label,position:{now:void 0},wait:{},flag:k(),count:0};if("number"!=typeof e[g].count[l.type]?e[g].count[l.type]=1:e[g].count[l.type]++,h.actionRef&&(l.actionRef=h.actionRef,l.commands=[{location:0,times:1,actions:b[g].actions.ref[h.actionRef],label:a}]),h.movement)l.movement=h.movement;else{if(h.position||(h.position={}),h.position.now?l.position.now=h.position.now.slice():i?l.position.now=i.position.now.slice():l.position.now=b[g].configs.position(),h.position.end)l.position.end=h.position.end,l.direction.value=q(l.position.now,l.position.end);else{if(!h.direction)throw new Error("Invalid fire direction");switch(l.direction||(l.direction={}),h.direction.type){case"aim":l.direction.value=q(l.position.now,b[g].configs.target[h.direction.target]())+(h.direction.value||0),e[g].fire.temp[a][h.label].direction.type="aim";break;case"absolute":l.direction.value=h.direction.value;break;case"sequence":"number"!=typeof e[g].fire.temp[a][h.label].direction.value?(h.direction.base?e[g].fire.temp[a][h.label].direction.base=h.direction.base:e[g].fire.temp[a][h.label].direction.base=0,e[g].fire.temp[a][h.label].direction.value=e[g].fire.temp[a][h.label].direction.base):"number"==typeof e[g].fire.temp[a][h.label].direction.value&&(e[g].fire.temp[a][h.label].direction.value+=h.direction.value,e[g].fire.temp[a][h.label].direction.root=h.direction.value),l.direction.value=e[g].fire.temp[a][h.label].direction.value+function(){return h.direction.target?q(l.position.now,b[g].configs.target[h.direction.target]()):0}(),e[g].fire.temp[a][h.label].direction.type="sequence";break;case"relative":if(!b[g].actions.ref[a])throw new Error("Relative must be use in actionRef");l.direction.value=h.direction.value,l.direction.value+=i.direction.value;break;default:l.direction.value=0}}if(!h.speed)throw new Error("Invalid fire speed");switch(l.speed||(l.speed={}),h.speed.horizontal.type){case"absolute":l.speed.horizontal=h.speed.horizontal.value;break;case"sequence":"number"!=typeof e[g].fire.temp[a][h.label].speed.horizontal.value?(h.speed.horizontal.base?e[g].fire.temp[a][h.label].speed.horizontal.base=h.speed.horizontal.base:e[g].fire.temp[a][h.label].speed.horizontal.base=1,e[g].fire.temp[a][h.label].speed.horizontal.value=e[g].fire.temp[a][h.label].speed.horizontal.base):"number"==typeof e[g].fire.temp[a][h.label].speed.horizontal.value&&(e[g].fire.temp[a][h.label].speed.horizontal.value+=h.speed.horizontal.value,e[g].fire.temp[a][h.label].speed.horizontal.root=h.speed.horizontal.value),l.speed.horizontal=e[g].fire.temp[a][h.label].speed.horizontal.value,e[g].fire.temp[a][h.label].speed.horizontal.type="sequence";break;case"relative":if(!b[g].actions.ref[a])throw new Error("Relative must be use in actionRef");l.speed.horizontal=h.speed.horizontal.value,l.speed.horizontal+=i.speed.horizontal.value;break;default:l.speed.horizontal=1}switch(h.speed.vertical.type){case"absolute":l.speed.vertical=h.speed.vertical.value;break;case"sequence":"number"!=typeof e[g].fire.temp[a][h.label].speed.vertical.value?(h.speed.horizontal.base?e[g].fire.temp[a][h.label].speed.vertical.base=h.speed.vertical.base:e[g].fire.temp[a][h.label].speed.vertical.base=1,e[g].fire.temp[a][h.label].speed.vertical.value=e[g].fire.temp[a][h.label].speed.vertical.base):"number"==typeof e[g].fire.temp[a][h.label].speed.vertical.value&&(e[g].fire.temp[a][h.label].speed.vertical.value+=h.speed.vertical.value,e[g].fire.temp[a][h.label].speed.vertical.root=h.speed.vertical.value),l.speed.vertical=e[g].fire.temp[a][h.label].speed.vertical.value,e[g].fire.temp[a][h.label].speed.vertical.type="sequence";break;case"relative":if(!b[g].actions.ref[a])throw new Error("Relative must be use in actionRef");l.speed.vertical=h.speed.vertical.value,l.speed.vertical+=i.speed.vertical.value;break;default:l.speed.vertical=1}}return e[g].bullets[c][h.label].push(l),l=e[g].bullets[c][h.label][e[g].bullets[c][h.label].length-1]},draw:function(a){return a.change&&(a.change.direction&&a.change.direction.times>0&&(a.direction.value+=a.change.direction.change,a.change.direction.times--),a.change.speed&&(a.change.speed.horizontal&&a.change.speed.horizontal.times>0&&(a.speed.horizontal+=a.change.speed.horizontal.change,a.change.speed.horizontal.times--),a.change.speed.vertical&&a.change.speed.vertical.times>0&&(a.speed.vertical+=a.change.speed.vertical.change,a.change.speed.vertical.times--))),"function"==typeof a.movement?a.position.now=a.movement():(a.position.now[0]=Math.sin(p(a.direction.value))*a.speed.horizontal+a.position.now[0],a.position.now[1]=Math.cos(p(a.direction.value))*a.speed.vertical+a.position.now[1]),a},change:function(a,c,d,e,f,h){if(!b[g].actions.ref[a])throw new Error("Change must be called in not fire actions");if(h.change||(h.change={}),f.movement)h.movement=f.movement;else{if(f.position||(f.position={}),f.position.now&&(h.position.now=f.position.now.slice()),f.position.end)h.change.direction||(h.change.direction={}),h.position.end=f.position.end.slice(),h.change.direction.times=f.position.times||1,h.change.direction.value=q(h.position.now,f.position.end),h.change.direction.change=(h.change.direction.value-h.direction.value)/h.change.direction.times;else if(f.direction)switch(f.direction||(f.direction={}),h.change.direction||(h.change.direction={}),h.change.direction.value=f.direction.value||0,f.direction.type?h.change.direction.type=f.direction.type:h.change.direction.type="absolute",h.change.direction.times=f.direction.times||1,h.change.direction.type){case"aim":h.change.direction.change=(q(h.position.now,b[g].configs.target[f.direction.target]())+h.change.direction.value-h.direction.value)/h.change.direction.times;break;case"relative":h.change.direction.change=h.change.direction.value/h.change.direction.times;break;case"sequence":h.change.direction.change=(h.direction.value*h.change.direction.value-h.direction.value)/h.change.direction.times;break;case"absolute":h.change.direction.change=(h.change.direction.value-h.direction.value)/h.change.direction.times}if(f.speed){if(h.change.speed||(h.change.speed={}),f.speed.horizontal)switch(h.change.speed.horizontal||(h.change.speed.horizontal={}),h.change.speed.horizontal.value=f.speed.horizontal.value||0,f.speed.horizontal.type?h.change.speed.horizontal.type=f.speed.horizontal.type:h.change.speed.horizontal.type="absolute",h.change.speed.horizontal.times=f.speed.horizontal.times||1,h.change.speed.horizontal.type){case"relative":h.change.speed.horizontal.change=h.change.speed.horizontal.value/h.change.speed.horizontal.times;break;case"sequence":h.change.speed.horizontal.change=(h.speed.horizontal*h.change.speed.horizontal.value-h.speed.horizontal)/h.change.speed.horizontal.times;break;case"absolute":h.change.speed.horizontal.change=(h.change.speed.horizontal.value-h.speed.horizontal)/h.change.speed.horizontal.times}if(f.speed.vertical)switch(h.change.speed.vertical||(h.change.speed.vertical={}),h.change.speed.vertical.value=f.speed.vertical.value||0,f.speed.vertical.type?h.change.speed.vertical.type=f.speed.vertical.type:h.change.speed.vertical.type="absolute",h.change.speed.vertical.times=f.speed.vertical.times||1,h.change.speed.vertical.type){case"relative":h.change.speed.vertical.change=h.change.speed.vertical.value/h.change.speed.vertical.times;break;case"sequence":h.change.speed.vertical.change=(h.speed.vertical*h.change.speed.vertical.value-h.speed.vertical)/h.change.speed.vertical.times;break;case"absolute":h.change.speed.vertical.change=(h.change.speed.vertical.value-h.speed.vertical)/h.change.speed.vertical.times}}}},freeze:function(a,b,c,d,e,f){},reset:function(a,b,c,d,f,h){var i=e[g].fire.temp[a][f.label];if("direction"===f.type){if("sequence"!==i.direction.type)throw new Error("direction type is not sequence or aim");i.direction.value=(f.value||i.direction.base)-i.direction.root}else if("horizontal"===f.type){if("sequence"!==i.speed.horizontal)throw new Error("speed horizontal type is not sequence");i.speed.horizontal.value=(f.value||i.speed.horizontal.base)-i.speed.horizontal.root}else{if("vertical"!==f.type)throw new Error("Undefined type");if("sequence"!==i.speed.vertical)throw new Error("speed vertical type is not sequence");i.speed.vertical.value=(f.value||i.speed.vertical.base)-i.speed.vertical.root}},vanish:function(a,c,d,f,h,i){var j=function(){if("current"===h.type){if(i)return i.label;throw new Error("Current must use in actionRef")}if(h.label)return h.label;if(i)return i.label;throw new Error("Label didn't defined")}(),k=e[g].bullets[c][j],l=0,m=k.length-1,n=function(){if(a!==c)return i.type;if(a===c){if(h.label)return e[g].fire.data[a][j].type;throw new Error("Label must be defined in vanish main action")}}();!function a(){switch(h.type){case"current":e[g].count[i.type]--,b[g].configs.shot[n].vanish(k[i.count]),k[i.count]=null;break;case"first":for(l=0;l<h.value;l++){if(k.length<h.value){h={type:"all"},a();break}e[g].count[k[l].type]--,b[g].configs.shot[n].vanish(k[l]),k[l]=null}break;case"last":for(l=0;l<h.value;l++){if(k.length<h.value){h={type:"all"},a();break}e[g].count[k[m].type]--,b[g].configs.shot[n].vanish(k[m]),k[m]=null,m--}break;case"random":for(l=0;l<h.value;l++){do if(m=Math.floor(Math.random()*k.length),k.every(function(a){return null===a}))break;while(null===k[m]);e[g].count[k[m].type]--,b[g].configs.shot[n].vanish(k[m]),k[m]=null}break;default:for(l=0;l<k.length;l++)e[g].count[k[l].type]--,b[g].configs.shot[n].vanish(k[l]),k[l]=null}}()}},Math.normalizeRadian=function(a){for(a%=2*Math.PI;a<=-Math.PI;)a+=2*Math.PI;for(;Math.PI<a;)a-=2*Math.PI;return a},Math.normalizeDegree=function(a){for(a%=360;a<=0;)a+=360;for(;180<a;)a-=360;return a},Math.pythagoreanPos=function(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2))},Math.radToDeg=function(a){return a%=2*Math.PI,a*(180/Math.PI)},Math.degToRad=function(a){return a%=360,a*(Math.PI/180)},h=function(a){return g=a,b[g]||(b[g]={}),e[g]||(e[g]={}),c},"function"==typeof define&&define.amd?void define(function(){return h}):"undefined"!=typeof module&&module.exports?void(module.exports=h):void(a.Shmup=h)}("undefined"!=typeof window?window:{});